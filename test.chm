// CHM test source code
#include "stl.h"

/*/

<a, b : c ~ a : <b> >
class PseudoPointer<a>
{
	b deref(c);
}

<a>
struct pointer
{
	a* where;
};

<a : c ~ struct pointer : <a> >
instance PseudoPointer<struct pointer>
{
	a deref(c x)
	{
		return *x.where;
	}
}

<a, b: c ~ a : <b>, PseudoPointer<a> >
b f(c x)
{
	return deref(x);
}

< : c ~ struct pointer : <int> >
int g()
{
	c x;
	return f(x);
}

int main()
{
	g();
	int i;
}

/*/

<a : b ~ struct List : <a> >
struct List
{
	b *next;
	a value;
};

<a : b ~ struct List : <a> >
b *push(b *head, a value)
{
    b *item = new();
    // new() is an stl function behaving as malloc(sizeof(b))
    item->value = value;
    item->next = head;
    return item;
}

<a : b ~ struct List : <a> >
b *pull(b *head)
{
	b* next = head->next;
	delete(head);
	return next;
}

<a>
int f()
{
	a x = push(nullptr(), 1);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 4);
	x = push(x, 2);
	x = push(x, 3);
	x = push(x, 'c');
}

int main()
{
	int (*x)() = &f;
	(*x)();
	char i = 'c';
	print(&i);
}

/**/
